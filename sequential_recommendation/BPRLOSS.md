[推荐系统中的BPR算法 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/60704781)

https://www.cnblogs.com/pinard/p/9128682.html

1. 背景：
    - 推荐系统的目标是根据用户的历史行为和兴趣，向他们推荐最相关的物品。 协同过滤是一种流行的方法 ，它基于用户与其他用户或物品的历史行为之间的相似性来进行推荐。
    - BPRLoss的灵感来自于排名问题，它关注的是给定一对用户和物品，用户是否更喜欢第一个物品而不是第二个物品。
2. 计算目标：
    - BPRLoss的目标是最大化观察到的用户-物品对中的正样本（用户喜欢的物品）的分数高于负样本（用户不喜欢的物品）的概率。
3. 公式：
    - 给定一个用户 u 和两个物品 i 和 j，BPRLoss的损失函数可以表示为：
        BPRLoss = -∑log(σ(x_uij - x_uji)) + λ * Θ
    其中：
    - x_uij 是用户 u 对物品 i 的预测评分减去用户 u 对物品 j 的预测评分。
    - σ(x) 是逻辑sigmoid函数，定义为 1 / (1 + exp(-x))，用于将分数映射到概率范围 [0, 1]。
    - λ 是正则化项的权重，用于防止过拟合。
    - Θ 表示模型的参数，需要通过梯度下降等优化算法来学习。
4. 计算方法：
    - 计算BPRLoss的步骤通常包括以下几个阶段： a. 对于每个用户 u，随机选择一个正样本物品 i 和一个负样本物品 j，其中正样本是用户 u 喜欢的物品，负样本是用户 u 没有喜欢的物品。 b. 计算用户 u 对物品 i 和物品 j 的预测评分，这通常涉及到模型的前向传播。 c. 使用上述公式计算BPRLoss，然后使用反向传播算法来更新模型参数 Θ，以最小化这个损失函数。
