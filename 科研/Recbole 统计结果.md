```shell
cp run_S3Rec_beauty.py run_S3Rec_beauty_pretrain.py
cp run_S3Rec_beauty.py run_S3Rec_beauty_finetune.py
cp run_S3Rec_beauty.sh run_S3Rec_beauty_pretrain.sh
cp run_S3Rec_beauty.sh run_S3Rec_beauty_finetune.sh

sbatch ./run_S3Rec_beauty_pretrain.sh 
```


```python
virt-install --os-type=linux --os-variant rhel7.0 --name vm01-host01 --memory 1024 --vcpus 1 --disk /root/桌面/vm01-host01.raw,format=raw,size=10 --cdrom /root/桌面/CentOS-7-x86_64-DVD-2009.iso --network network=default --graphics vnc,listen=0.0.0.0 --noautoconsole

virt-install --os-type=linux --os-variant rhel7.0 --name vm01-host01 --memory 1024 --vcpus 1 --disk /home/ldx/cloud_comp/vm/vm01host01.raw,format=raw,size=10 --cdrom /home/ldx/cloud_comp/CSP-v0.3-2020.09.27.iso --network network=default --graphics vnc,listen=0.0.0.0 --noautoconsole

virt-install --virt-type kvm --os-type=linux --os-variant rhel7.0 --name vm01-host01 --memory 1024 --vcpus 1 --disk /vm01host01.raw,format=raw,size=10 --cdrom /CentOS-7-x86_64-DVD-2009.iso --network network=default --graphics vnc,listen=0.0.0.0 --noautoconsole


```
# Amazon_beauty
![[fe05ae55104142493c8c7aa6a3b853e.png]]

## @5

### gru vs narm
```python
数据集FINAL/beauty/5/
模型FINAL/beauty/5/GRU4Rec 和模型 FINAL/beauty/5/NARM比较
对于所有的用户
intersection 部分占全体比例 0.01931711509969577
d1 部分占全体比例0.016964679537203542
d2 部分占全体比例0.01777898415498931
model1 部分占全体比例0.03628179463689931
model2 部分占全体比例0.03709609925468508
intersection最大值205
d1最大值131
d2最大值109
intersection中位数4.0
d1中位数4.0
d2中位数4.0
intersection平均值5.716627634660422
d1平均值6.728
d2平均值6.338422391857506

对所有的物品
intersection 部分占全体比例 0.2643041903776513
d1 部分占全体比例0.016270046559751682
d2 部分占全体比例0.5273409208484221
model1 部分占全体比例0.280574236937403
model2 部分占全体比例0.7916451112260735
intersection最大值7533
d1最大值151
d2最大值2143
intersection中位数35.0
d1中位数12.0
d2中位数17.0
intersection平均值74.17694265022509
d1平均值17.79650238473768
d2平均值28.3138274390543

对所有命中的物品
intersection 部分占全体比例 0.016063114330056905
d1 部分占全体比例0.0071132953957578895
d2 部分占全体比例0.020796689084324884
model1 部分占全体比例0.023176409725814796
model2 部分占全体比例0.03685980341438179
intersection最大值7533
d1最大值818
d2最大值2143
intersection中位数103.0
d1中位数80.0
d2中位数44.0
intersection平均值229.1658615136876
d1平均值139.0981818181818
d2平均值86.9950248756219

模型FINAL/beauty/5/GRU4Rec的ils均值 = 3.165615698974815
模型FINAL/beauty/5/NARM的ils均值 = 10.880328065096295
```

### gru vs sas
```python
数据集FINAL/beauty/5/
模型FINAL/beauty/5/GRU4Rec 和模型 FINAL/beauty/5/SASRec比较
对于所有的用户
intersection 部分占全体比例 0.02182788767120189
d1 部分占全体比例0.014453906965697419
d2 部分占全体比例0.025447019305805313
model1 部分占全体比例0.03628179463689931
model2 部分占全体比例0.0472749069770072
intersection最大值205
d1最大值131
d2最大值135
intersection中位数4.0
d1中位数4.0
d2中位数4.0
intersection平均值5.758549222797927
d1平均值6.84037558685446
d2平均值6.419111111111111

对所有的物品
intersection 部分占全体比例 0.2627521986549405
d1 部分占全体比例0.010346611484738748
d2 部分占全体比例0.612338334195551
model1 部分占全体比例0.27309881013967924
model2 部分占全体比例0.8750905328504914
intersection最大值7533
d1最大值287
d2最大值2143
intersection中位数34.0
d1中位数14.0
d2中位数16.0
intersection平均值73.77692459145501
d1平均值24.4775
d2平均值26.72018755544291

对所有命中的物品
intersection 部分占全体比例 0.016451112260734608
d1 部分占全体比例0.006725297465080186
d2 部分占全体比例0.02834971546818417
model1 部分占全体比例0.023176409725814796
model2 部分占全体比例0.04480082772891878
intersection最大值7533
d1最大值1379
d2最大值1838
intersection中位数98.0
d1中位数91.5
d2中位数36.0
intersection平均值212.54088050314465
d1平均值174.56923076923076
d2平均值71.03923357664233

模型FINAL/beauty/5/GRU4Rec的ils均值 = 3.165615698974815
模型FINAL/beauty/5/SASRec的ils均值 = 25.217188917460746
```


### sas vs bert
```python
数据集FINAL/beauty/5/
模型FINAL/beauty/5/SASRec 和模型 FINAL/beauty/5/BERT4Rec比较
对于所有的用户
intersection 部分占全体比例 0.01736052205973829
d1 部分占全体比例0.029914384917268912
d2 部分占全体比例0.007419219850937016
model1 部分占全体比例0.0472749069770072
model2 部分占全体比例0.024779741910675307
intersection最大值205
d1最大值78
d2最大值77
intersection中位数4.0
d1中位数4.0
d2中位数5.0
intersection平均值6.345928338762215
d1平均值5.979584120982987
d2平均值7.213414634146342

对所有的物品
intersection 部分占全体比例 0.5600620796689084
d1 部分占全体比例0.3024055871702018
d2 部分占全体比例0.05129332643559234
model1 部分占全体比例0.8624676668391101
model2 部分占全体比例0.6113554061045008
intersection最大值7533
d1最大值507
d2最大值287
intersection中位数26.0
d1中位数13.0
d2中位数13.0
intersection平均值53.65282652872714
d1平均值18.193909845180052
d2平均值18.656076651538072

对所有命中的物品
intersection 部分占全体比例 0.017459906880496638
d1 部分占全体比例0.027340920848422143
d2 部分占全体比例0.007294361096740818
model1 部分占全体比例0.04480082772891878
model2 部分占全体比例0.024754267977237454
intersection最大值7533
d1最大值1430
d2最大值1379
intersection中位数75.0
d1中位数41.0
d2中位数85.0
intersection平均值190.14666666666668
d1平均值80.11920529801324
d2平均值151.69148936170214

模型FINAL/beauty/5/SASRec的ils均值 = 25.217188917460746
模型FINAL/beauty/5/BERT4Rec的ils均值 = 3.915928693382747

```

## @10

### gru vs narm

```python
数据集beauty@10
模型GRU4Rec 和模型 NARM比较
对于所有的用户
intersection 部分占全体比例 2.2085691188358934
d1 部分占全体比例1.4955537590945838
d2 部分占全体比例1.4640258690379953
model1 部分占全体比例3.704122877930477
model2 部分占全体比例3.6725949878738886
intersection最大值209
d1最大值326
d2最大值63
intersection中位数22.0
d1中位数35.5
d2中位数23.5
intersection平均值37.5
d1平均值55.714285714285715
d2平均值30.583333333333332

对所有的物品
intersection 部分占全体比例 19.29346314325452
d1 部分占全体比例0.8442280945757997
d2 部分占全体比例24.600834492350486
model1 部分占全体比例20.13769123783032
model2 部分占全体比例43.89429763560501
intersection最大值2088
d1最大值244
d2最大值2477
intersection中位数81.5
d1中位数63.0
d2中位数76.0
intersection平均值127.28787878787878
d1平均值72.72727272727273
d2平均值119.93957703927492

对所有命中的物品
intersection 部分占全体比例 1.262865090403338
d1 部分占全体比例0.4812239221140473
d2 部分占全体比例1.187760778859527
model1 部分占全体比例1.7440890125173854
model2 部分占全体比例2.4506258692628653
intersection最大值44
d1最大值194
d2最大值256
intersection中位数40.0
d1中位数99.0
d2中位数74.0
intersection平均值34.333333333333336
d1平均值105.66666666666667
d2平均值96.66666666666667

模型GRU4Rec的ils均值 = 2.88147884421043
模型NARM的ils均值 = 4.302989631616368
```
### gru vs sas

```python
数据集beauty@10
模型GRU4Rec 和模型 SASRec比较
对于所有的用户
intersection 部分占全体比例 2.367825383993533
d1 部分占全体比例1.3362974939369443
d2 部分占全体比例2.2894098625707358
model1 部分占全体比例3.704122877930477
model2 部分占全体比例4.657235246564269
intersection最大值209
d1最大值326
d2最大值63
intersection中位数25.0
d1中位数30.5
d2中位数18.0
intersection平均值41.083333333333336
d1平均值50.75
d2平均值23.689655172413794

对所有的物品
intersection 部分占全体比例 19.663421418636997
d1 部分占全体比例0.3240611961057024
d2 部分占全体比例29.55076495132128
model1 部分占全体比例19.9874826147427
model2 部分占全体比例49.21418636995828
intersection最大值2088
d1最大值67
d2最大值2477
intersection中位数80.0
d1中位数57.0
d2中位数77.0
intersection平均值121.24723247232473
d1平均值57.0
d2平均值127.44168734491315

对所有命中的物品
intersection 部分占全体比例 1.3198887343532684
d1 部分占全体比例0.4242002781641168
d2 部分占全体比例1.8539638386648123
model1 部分占全体比例1.7440890125173854
model2 部分占全体比例3.1738525730180807
intersection最大值194
d1最大值160
d2最大值272
intersection中位数56.0
d1中位数89.0
d2中位数66.5
intersection平均值77.33333333333333
d1平均值98.33333333333333
d2平均值107.28571428571429

模型GRU4Rec的ils均值 = 2.88147884421043
模型SASRec的ils均值 = 21.835496611582993
```
### sas vs bert

```python
数据集beauty@10
模型SASRec 和模型 BERT4Rec比较
对于所有的用户
intersection 部分占全体比例 1.8270008084074374
d1 部分占全体比例2.830234438156831
d2 部分占全体比例0.6604688763136621
model1 部分占全体比例4.657235246564269
model2 部分占全体比例2.4874696847210993
intersection最大值209
d1最大值63
d2最大值31
intersection中位数19.0
d1中位数20.0
d2中位数16.0
intersection平均值41.875
d1平均值25.606060606060606
d2平均值19.666666666666668

对所有的物品
intersection 部分占全体比例 35.29763560500695
d1 部分占全体比例13.561891515994438
d2 部分占全体比例1.5771905424200279
model1 部分占全体比例48.85952712100139
model2 部分占全体比例36.87482614742698
intersection最大值2088
d1最大值2477
d2最大值254
intersection中位数77.0
d1中位数77.0
d2中位数72.0
intersection平均值123.583984375
d1平均值129.33986928104576
d2平均值87.0

对所有命中的物品
intersection 部分占全体比例 1.3393602225312935
d1 部分占全体比例1.8344923504867872
d2 部分占全体比例0.3908205841446453
model1 部分占全体比例3.1738525730180807
model2 部分占全体比例1.7301808066759388
intersection最大值116
d1最大值272
d2最大值153
intersection中位数40.0
d1中位数68.0
d2中位数86.5
intersection平均值48.6
d1平均值114.86666666666666
d2平均值94.16666666666667

模型SASRec的ils均值 = 21.835496611582993
模型BERT4Rec的ils均值 = 3.644048585514944
```

# Amazon_toys
![[df59e683908417539e11e0bb7ad805a.png]]
## @5

### gru vs narm
```python
数据集FINAL/toys/5/
模型FINAL/toys/5/GRU4Rec 和模型 FINAL/toys/5/NARM比较
对于所有的用户
intersection 部分占全体比例 0.06186455281750818
d1 部分占全体比例0.02386696536274341
d2 部分占全体比例0.022316043425814235
model1 部分占全体比例0.0857315181802516
model2 部分占全体比例0.08418059624332241
intersection最大值389
d1最大值241
d2最大值151
intersection中位数22.0
d1中位数23.0
d2中位数23.0
intersection平均值28.890934844192635
d1平均值30.974358974358974
d2平均值28.0748031496063

对所有的物品
intersection 部分占全体比例 0.5225345287133512
d1 部分占全体比例0.06493821177610855
d2 部分占全体比例0.2740489459655924
model1 部分占全体比例0.5874727404894596
model2 部分占全体比例0.7965834746789435
intersection最大值12680
d1最大值2702
d2最大值7487
intersection中位数162.0
d1中位数182.0
d2中位数179.0
intersection平均值293.78075489282384
d1平均值301.2598130841121
d2平均值300.09413854351686

对所有命中的物品
intersection 部分占全体比例 0.0518536467167434
d1 部分占全体比例0.019626847589047734
d2 部分占全体比例0.02144414829173734
model1 部分占全体比例0.07148049430579113
model2 部分占全体比例0.07329779500848074
intersection最大值6617
d1最大值4169
d2最大值2721
intersection中位数191.0
d1中位数132.5
d2中位数144.0
intersection平均值346.59810874704493
d1平均值307.89375
d2平均值267.728813559322

模型FINAL/toys/5/GRU4Rec的ils均值 = 1.046361156717208
模型FINAL/toys/5/NARM的ils均值 = 1.9230569408145028
```

### gru vs sas
```python
数据集FINAL/toys/5/
模型FINAL/toys/5/GRU4Rec 和模型 FINAL/toys/5/SASRec比较
对于所有的用户
intersection 部分占全体比例 0.06832672755471308
d1 部分占全体比例0.017404790625538513
d2 部分占全体比例0.032052386696536275
model1 部分占全体比例0.0857315181802516
model2 部分占全体比例0.10037911425124936
intersection最大值389
d1最大值241
d2最大值472
intersection中位数22.0
d1中位数25.0
d2中位数24.0
intersection平均值29.030729833546737
d1平均值31.21212121212121
d2平均值30.172602739726027

对所有的物品
intersection 部分占全体比例 0.5128422582990065
d1 部分占全体比例0.05161133995638478
d2 部分占全体比例0.3355948630966804
model1 部分占全体比例0.5644535982553913
model2 部分占全体比例0.8484371213956869
intersection最大值12680
d1最大值3886
d2最大值7487
intersection中位数163.0
d1中位数174.5
d2中位数178.0
intersection平均值292.07832898172325
d1平均值302.39858490566036
d2平均值301.63633067440173

对所有命中的物品
intersection 部分占全体比例 0.05863823600678459
d1 部分占全体比例0.012842258299006542
d2 部分占全体比例0.0311364187060819
model1 部分占全体比例0.07148049430579113
model2 部分占全体比例0.08977465471286648
intersection最大值6617
d1最大值3886
d2最大值2256
intersection中位数187.0
d1中位数132.5
d2中位数147.0
intersection平均值346.33402922755744
d1平均值288.2692307692308
d2平均值245.46666666666667

模型FINAL/toys/5/GRU4Rec的ils均值 = 1.046361156717208
模型FINAL/toys/5/SASRec的ils均值 = 0.8910874672027622
```

### sas vs bert
```python
数据集FINAL/toys/5/
模型FINAL/toys/5/SASRec 和模型 FINAL/toys/5/BERT4Rec比较
对于所有的用户
intersection 部分占全体比例 0.06393244873341375
d1 部分占全体比例0.036446665517835604
d2 部分占全体比例0.012579700155092194
model1 部分占全体比例0.10037911425124936
model2 部分占全体比例0.07651214888850595
intersection最大值389
d1最大值472
d2最大值254
intersection中位数22.0
d1中位数23.0
d2中位数23.0
intersection平均值28.60522696011004
d1平均值30.763723150357997
d2平均值31.21232876712329

对所有的物品
intersection 部分占全体比例 0.6283014296098861
d1 部分占全体比例0.2143203295371941
d2 部分占全体比例0.07874969711654956
model1 部分占全体比例0.8426217591470802
model2 部分占全体比例0.7070511267264357
intersection最大值12680
d1最大值8816
d2最大值4007
intersection中位数165.0
d1中位数185.0
d2中位数194.0
intersection平均值287.00523255813954
d1平均值322.70431328036324
d2平均值313.4476923076923

对所有命中的物品
intersection 部分占全体比例 0.055972861642839836
d1 部分占全体比例0.033801793070026655
d2 部分占全体比例0.01090380421613763
model1 部分占全体比例0.08977465471286648
model2 部分占全体比例0.06687666585897746
intersection最大值6617
d1最大值4169
d2最大值3886
intersection中位数182.0
d1中位数148.0
d2中位数109.5
intersection平均值334.3501094091904
d1平均值273.2490974729242
d2平均值249.6888888888889

模型FINAL/toys/5/SASRec的ils均值 = 0.8910874672027622
模型FINAL/toys/5/BERT4Rec的ils均值 = 19.01268536168777
```

## @10

### gru vs narm

```python

```
### gru vs sas

```python
	
```
### sas vs bert

```python
D:\software\anaconda\envs\recbole_clone\python.exe E:\RecBole-master_test\RecBole-master\data_analyse.py 



数据集FINAL/toys/10/
模型FINAL/toys/10/SASRec 和模型 FINAL/toys/10/BERT4Rec比较
对于所有的用户
intersection 部分占全体比例 0.15402451142762505
d1 部分占全体比例0.0935740311361378
d2 部分占全体比例0.0332891685988738
model1 部分占全体比例0.24759854256376285
model2 部分占全体比例0.18731368002649884
intersection最大值1243
d1最大值1850
d2最大值1019
intersection中位数92.0
d1中位数104.5
d2中位数100.0
intersection平均值155.70909090909092
d1平均值177.96456692913387
d2平均值189.3

对所有的物品
intersection 部分占全体比例 1.9856767027185034
d1 部分占全体比例0.26220403390821395
d2 部分占全体比例0.11078631978953522
model1 部分占全体比例2.2478807366267173
model2 部分占全体比例2.0964630225080385
intersection最大值3428
d1最大值2538
d2最大值2991
intersection中位数144.0
d1中位数144.0
d2中位数206.0
intersection平均值286.9629025682837
d1平均值285.5744680851064
d2平均值358.15384615384613

对所有命中的物品
intersection 部分占全体比例 0.17451037708272435
d1 部分占全体比例0.10201695410698626
d2 部分占全体比例0.03449283835135925
model1 部分占全体比例0.2765273311897106
model2 部分占全体比例0.2090032154340836
intersection最大值1728
d1最大值1229
d2最大值1495
intersection中位数264.0
d1中位数221.0
d2中位数105.5
intersection平均值343.05641025641023
d1平均值352.94520547945206
d2平均值345.2142857142857

模型FINAL/toys/10/SASRec的ils均值 = 0.6526383605704494
模型FINAL/toys/10/BERT4Rec的ils均值 = 37.78834375268642

进程已结束,退出代码0

```



# Amazon_sports
![[1af284b9e30a3bbcaad61d7891b1d16.png]]

## @5

### gru vs narm
```python

```

### gru vs sas
```python
```

### sas vs bert
```python
```

## @10

### gru vs narm

```python
数据集FINAL/sports/10/
模型FINAL/sports/10/GRU4Rec 和模型 FINAL/sports/10/NARM比较
对于所有的用户
intersection 部分占全体比例 0.3646902947996025
d1 部分占全体比例0.07966213978138456
d2 部分占全体比例0.09224908910235177
model1 部分占全体比例0.44435243458098705
model2 部分占全体比例0.45693938390195427
intersection最大值1518
d1最大值1286
d2最大值1595
intersection中位数98.0
d1中位数90.0
d2中位数88.0
intersection平均值158.438
d1平均值160.73636363636365
d2平均值166.05982905982907

对所有的物品
intersection 部分占全体比例 2.46565331774335
d1 部分占全体比例0.2952353113124817
d2 部分占全体比例0.8099970768781058
model1 部分占全体比例2.7608886290558314
model2 部分占全体比例3.2756503946214557
intersection最大值3428
d1最大值2538
d2最大值2990
intersection中位数112.0
d1中位数119.5
d2中位数223.5
intersection平均值257.1929411764706
d1平均值243.62589928057554
d2平均值364.3712871287129

对所有命中的物品
intersection 部分占全体比例 0.2829581993569132
d1 部分占全体比例0.05144694533762058
d2 部分占全体比例0.08535515931014323
model1 部分占全体比例0.33440514469453375
model2 部分占全体比例0.3683133586670564
intersection最大值2514
d1最大值798
d2最大值1666
intersection中位数63.0
d1中位数129.0
d2中位数194.0
intersection平均值122.45508982035928
d1平均值203.24
d2平均值418.38461538461536

模型FINAL/sports/10/GRU4Rec的ils均值 = 1.4062347825099453
模型FINAL/sports/10/NARM的ils均值 = 9.413743015845386
```
### gru vs sas

```python
数据集FINAL/sports/10/
模型FINAL/sports/10/GRU4Rec 和模型 FINAL/sports/10/SASRec比较
对于所有的用户
intersection 部分占全体比例 0.3560781715799934
d1 部分占全体比例0.08827426300099371
d2 部分占全体比例0.11129513083802584
model1 部分占全体比例0.44435243458098705
model2 部分占全体比例0.4673733024180192
intersection最大值1518
d1最大值1216
d2最大值852
intersection中位数95.0
d1中位数100.0
d2中位数109.5
intersection平均值158.87891440501045
d1平均值158.75572519083968
d2平均值167.54545454545453

对所有的物品
intersection 部分占全体比例 2.5565624086524408
d1 部分占全体比例0.1400175387313651
d2 部分占全体比例1.106693949137679
model1 部分占全体比例2.696579947383806
model2 部分占全体比例3.66325635779012
intersection最大值3428
d1最大值2288
d2最大值2991
intersection中位数107.0
d1中位数147.0
d2中位数228.5
intersection平均值246.44348615524285
d1平均值352.96178343949043
d2平均值369.0175

对所有命中的物品
intersection 部分占全体比例 0.2785735165156387
d1 部分占全体比例0.05583162817889506
d2 部分占全体比例0.11283250511546332
model1 部分占全体比例0.33440514469453375
model2 部分占全体比例0.391406021631102
intersection最大值2514
d1最大值789
d2最大值1725
intersection中位数60.0
d1中位数130.0
d2中位数241.0
intersection平均值120.3150406504065
d1平均值212.8235294117647
d2平均值331.5581395348837

模型FINAL/sports/10/GRU4Rec的ils均值 = 1.4062347825099453
模型FINAL/sports/10/SASRec的ils均值 = 8.861660431466905
```
### sas vs bert

```python
数据集FINAL/sports/10/
模型FINAL/sports/10/SASRec 和模型 FINAL/sports/10/BERT4Rec比较
对于所有的用户
intersection 部分占全体比例 0.3431599867505797
d1 部分占全体比例0.12421331566743955
d2 部分占全体比例0.06989069228221265
model1 部分占全体比例0.4673733024180192
model2 部分占全体比例0.4130506790327923
intersection最大值1518
d1最大值923
d2最大值873
intersection中位数100.0
d1中位数81.0
d2中位数94.0
intersection平均值164.4375
d1平均值151.5147928994083
d2平均值167.34722222222223

对所有的物品
intersection 部分占全体比例 3.2069570301081556
d1 部分占全体比例0.43934522069570303
d2 部分占全体比例0.26015784858228586
model1 部分占全体比例3.6463022508038585
model2 部分占全体比例3.4671148786904413
intersection最大值3428
d1最大值2590
d2最大值2318
intersection中位数137.0
d1中位数121.0
d2中位数231.0
intersection平均值280.62423749491666
d1平均值275.23440453686203
d2平均值361.10069444444446

对所有命中的物品
intersection 部分占全体比例 0.2747734580532008
d1 部分占全体比例0.1166325635779012
d2 部分占全体比例0.05466237942122187
model1 部分占全体比例0.391406021631102
model2 部分占全体比例0.3294358374744227
intersection最大值1548
d1最大值2514
d2最大值1730
intersection中位数59.0
d1中位数234.0
d2中位数189.0
intersection平均值109.72921108742004
d1平均值333.1666666666667
d2平均值407.09090909090907

模型FINAL/sports/10/SASRec的ils均值 = 8.861660431466905
模型FINAL/sports/10/BERT4Rec的ils均值 = 2.653998503571551
```

# ml-lm

## @5

### gru vs narm
```python
数据集FINAL/ml1m/5/
模型FINAL/ml1m/5/GRU4Rec 和模型 FINAL/ml1m/5/NARM比较
对于所有的用户
intersection 部分占全体比例 0.15402451142762505
d1 部分占全体比例0.05631003643590593
d2 部分占全体比例0.050513415038092084
model1 部分占全体比例0.21033454786353098
model2 部分占全体比例0.2045379264657171
intersection最大值1302
d1最大值1211
d2最大值844
intersection中位数72.0
d1中位数90.0
d2中位数78.0
intersection平均值131.7225806451613
d1平均值148.52507374631267
d2平均值140.5606557377049

对所有的物品
intersection 部分占全体比例 0.3890675241157556
d1 部分占全体比例0.17597193802981584
d2 部分占全体比例0.08155510084770536
model1 部分占全体比例0.5650394621455714
model2 部分占全体比例0.47062262496346097
intersection最大值2991
d1最大值2288
d2最大值3428
intersection中位数315.0
d1中位数116.0
d2中位数152.5
intersection平均值469.2924812030075
d1平均值231.2258064516129
d2平均值251.05434782608697

对所有命中的物品
intersection 部分占全体比例 0.13270973399590763
d1 部分占全体比例0.033031277404267756
d2 部分占全体比例0.022215726395790704
model1 部分占全体比例0.1657410114001754
model2 部分占全体比例0.15492546039169833
intersection最大值2991
d1最大值2578
d2最大值1669
intersection中位数413.0
d1中位数295.0
d2中位数266.5
intersection平均值582.3942731277533
d1平均值443.2212389380531
d2平均值377.4078947368421

模型FINAL/ml1m/5/GRU4Rec的ils均值 = 2.0472223687987436
模型FINAL/ml1m/5/NARM的ils均值 = 3.3265428327903264
```

### gru vs sas
```python
数据集FINAL/ml1m/5/
模型FINAL/ml1m/5/GRU4Rec 和模型 FINAL/ml1m/5/SASRec比较
对于所有的用户
intersection 部分占全体比例 0.12620072871811858
d1 部分占全体比例0.08413381914541239
d2 部分占全体比例0.04587611791984101
model1 部分占全体比例0.21033454786353098
model2 部分占全体比例0.17207684663795958
intersection最大值1302
d1最大值1211
d2最大值955
intersection中位数70.0
d1中位数87.5
d2中位数70.0
intersection平均值127.5137976346912
d1平均值149.24015748031496
d2平均值136.24548736462094

对所有的物品
intersection 部分占全体比例 0.4712072493422976
d1 部分占全体比例0.0941245249926922
d2 部分占全体比例0.13650979245834552
model1 部分占全体比例0.5653317743349898
model2 部分占全体比例0.6077170418006431
intersection最大值3428
d1最大值2288
d2最大值2223
intersection中位数286.5
d1中位数97.0
d2中位数135.0
intersection平均值438.3269230769231
d1平均值190.98376623376623
d2平均值215.13882863340564

对所有命中的物品
intersection 部分占全体比例 0.11984799766150249
d1 部分占全体比例0.045893013738672904
d2 部分占全体比例0.024554223911137093
model1 部分占全体比例0.1657410114001754
model2 部分占全体比例0.14440222157263957
intersection最大值2991
d1最大值2649
d2最大值1652
intersection中位数403.5
d1中位数375.0
d2中位数306.5
intersection平均值566.670731707317
d1平均值523.2866242038217
d2平均值407.98809523809524

模型FINAL/ml1m/5/GRU4Rec的ils均值 = 2.0472223687987436
模型FINAL/ml1m/5/SASRec的ils均值 = 0.8077724870711374
```

### sas vs bert
```python
数据集FINAL/ml1m/5/
模型FINAL/ml1m/5/SASRec 和模型 FINAL/ml1m/5/BERT4Rec比较
对于所有的用户
intersection 部分占全体比例 0.14143756210665784
d1 部分占全体比例0.030639284531301755
d2 部分占全体比例0.057138125207022196
model1 部分占全体比例0.17207684663795958
model2 部分占全体比例0.19857568731368003
intersection最大值1302
d1最大值893
d2最大值1009
intersection中位数70.0
d1中位数72.0
d2中位数78.0
intersection平均值128.53575615474796
d1平均值135.87567567567567
d2平均值136.57391304347826

对所有的物品
intersection 部分占全体比例 0.4580532008184741
d1 部分占全体比例0.11838643671441099
d2 部分占全体比例0.08886290558316282
model1 部分占全体比例0.5764396375328851
model2 部分占全体比例0.5469161064016369
intersection最大值3428
d1最大值2223
d2最大值1522
intersection中位数297.5
d1中位数113.5
d2中位数121.0
intersection平均值450.87228607918263
d1平均值194.5325
d2平均值209.156462585034

对所有命中的物品
intersection 部分占全体比例 0.12715580239695995
d1 部分占全体比例0.017246419175679626
d2 部分占全体比例0.03215434083601286
model1 部分占全体比例0.14440222157263957
model2 部分占全体比例0.15931014323297282
intersection最大值2991
d1最大值2538
d2最大值2649
intersection中位数404.0
d1中位数235.0
d2中位数395.0
intersection平均值552.2942528735632
d1平均值446.7457627118644
d2平均值537.1181818181818

模型FINAL/ml1m/5/SASRec的ils均值 = 0.8077724870711374
模型FINAL/ml1m/5/BERT4Rec的ils均值 = 1.8557841930393828
```

## @10

### gru vs narm

```python

```
### gru vs sas

```python

```
### sas vs bert

```python

```


# 规律总结

sas vs bert
1. 在ml beauty toys 中 bert 命中的用户平均流行度都更高。
2. ml beauty sports 中 sas 更喜欢推流行度高的物品。
gru vs sas
1. sas vs gru ml beauty sports 中   sas都推荐了更多流行的物品，但命中物品的流行度都偏低。
gru vs narm
1. narm 在 ml beauty sports 中 推荐物品的流行度都更高，toys 偏低。
2. gru 在 ml beauty toys 中 命中物品的流行度偏高。 sports 偏低


#  s3 调参结果


| beauty | 0d0003 | 0d0005 | 0d001  | 0d003  | 0d005  |
| ------ | ------ | ------ | ------ | ------ | ------ |
| recall | 0.067  | 0.0651 | 0.0669 | 0.0643 | 0.0238 |



| sports | 0d0003 | 0d0005 | 0d001 | 0d003 | 0d005 |
| ------ | ------ | ------ | ----- | ----- | ----- |
| recall | 0.1092 |        |       |       |       |


| toys   | 0d0003 | 0d0005 | 0d001 | 0d003 | 0d005  |
| ------ | ------ | ------ | ----- | ----- | ------ |
| recall |        |        |       | 0.12  | 0.1193 |


# Seed 2030


| ml-1m     | 0d0003 | 0d0005 | 0d001  | 0d003  | 0d005  |
| --------- | ------ | ------ | ------ | ------ | ------ |
| recall@10 | 0.2528 | 0.2594 | 0.2525 | 0.2247 | 0.2073 |

| beauty    | 0d0003 | 0d0005 | 0d001  | 0d003  | 0d005  |
| --------- | ------ | ------ | ------ | ------ | ------ |
| recall@10 | 0.0656 |        | 0.0676 | 0.0639 | 0.0243 |

| sports    | 0d0003 | 0d0005 | 0d001  | 0d003  | 0d005  |
| --------- | ------ | ------ | ------ | ------ | ------ |
| recall@10 | 0.1093 | 0.1094 | 0.1094 | 0.1063 | 0.1075 |

| toys      | 0d0003 | 0d0005 | 0d001  | 0d003 | 0d005  |
| --------- | ------ | ------ | ------ | ----- | ------ |
| recall@10 | 0.1261 | 0.1236 | 0.1207 | 0.116 | 0.1174 |


# 规律分析

## sas vs bert

ml @5 @10 @20 beauty @5 @10 @20 sports @5 @10 @20  toys @5 都满足 
sas 推荐物品流行度更高，但命中物品的流行度更低

除 ml 外, ml 刚好相反。
SASRec命中用户更多样更高(占所有的用户的比例更高)。

除 ml 外
SASRec 推荐的所有物品， 命中物品, 占所有物品的比例都更高。
## sas vs s3
各种比例都差不多

ml @20  beauty @5  sports 所有  toys 所有  都满足 
sas 推荐物品流行度更高，且命中物品的流行度也更高 (拆分开可能效果更加明显)
## gru vs sas
   
ml 全部  beauty 全部  sports @5 @10  
满足 gru 推荐物品流行度更低,  命中物品流行度更高。

除ml@20以外。
所有指标都满足 sas 推荐物品覆盖率更高，命中物品占所有物品的比例也更高
## gru vs narm

除 beauty 外 
gru 覆盖率更高。

除 sport@20 和 toys
gru 推荐的物品流行度都更高

除 ml@5 beauty @5 
narm 命中物品的流行度都更高。







